import { Image, Appear, Notes, Head, Split, Horizontal } from 'mdx-deck'
import {
  CodeSurfer,
  CodeSurferColumns,
  Step,
} from "code-surfer";
import { github, vsDark } from "@code-surfer/themes";
import "prismjs/components/prism-kotlin"

<Head>
  <title>GraphQL :heart: Kotlin</title>
</Head>

# GraphQL :heart: Kotlin

<Split>

  <img style="margin-right:2em;" src='https://upload.wikimedia.org/wikipedia/commons/thumb/7/74/Kotlin-logo.svg/800px-Kotlin-logo.svg.png' width='100'/>

  <img src='https://upload.wikimedia.org/wikipedia/commons/thumb/1/17/GraphQL_Logo.svg/1200px-GraphQL_Logo.svg.png' width='300'/>

</Split>

---

# L'instant promo

<Split>

<img src='https://upload.wikimedia.org/wikipedia/fr/c/c8/Twitter_Bird.svg' width='100'/>

[@AurelienAudelin](https://twitter.com/AurelienAudelin)

</Split>

<Split>

<img src='https://www.solutions-numeriques.com/wp-content/uploads/2015/01/linkedin-1424358279.png' width='100'/>

[in/aaudelin](https://www.linkedin.com/in/aaudelin/)

</Split>

<Split>

<img src='https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png' width='100'/>

[aaudelin](https://github.com/aaudelin)

</Split>

---

# On commence quand ?

<img src='https://media1.giphy.com/media/tXL4FHPSnVJ0A/giphy.gif' width='500'/>


---

# Son histoire :rocket:

<Appear>

## Créée par Facebook en 2012

## Rendu open source en 2015

</Appear>

---

# Les notions clés :dart:

<Appear>

## Langage de requêtage pour API (query, mutation, subscription)

## Runtime côté server pour traiter les requêtes

</Appear>

---

# Contrat entre client et server

<ul>

<Appear>

<li>Utilisable sur plusieurs langages</li>
<li>Documentation auto-générée par le code</li>
<li>Typé et possible de documenter</li>
<li>Développement client/server indépendants</li>

</Appear>

</ul>

---

# GraphQL :heart: HTTP

<ul>

<Appear>

<li>Un seul et unique endpoint (`/graphql`)</li>
<li>Une seule méthode HTTP (POST)</li>
<li>Echange de données au format JSON</li>
<li>Sécurisable par token</li>

</Appear>

</ul>

---

# Spring Boot :heart: GraphQL

<ul>

<Appear>

<li>[Librairie expedia](https://github.com/ExpediaGroup/graphql-kotlin)</li>
<li>Serveur Netty embarqué</li>
<li>Reactif</li>
<li>Auto-configuration & Metrics</li>
<li>Code first</li>

</Appear>

</ul>

---

<CodeSurfer theme={vsDark}>

```graphql title="Schéma GraphQL"
type Adresse {
  code: String
  code_hexacle_voie: String
  code_insee: String
  code_postal: String
  code_rivoli: String
  commune: String
  compl_voie: String
  id: Long!
  maj_par_mediapost: Boolean
  nom_voie: String
  num_voie: Int
  type_voie: String
  batiments(refParam: String): [Batiment!]!
}

type Batiment {
  ad_bat_code: String
  adr: Adresse
  cas_particulier: String
  conditions_syndic: String
  coordonnees: Coordonnees
  escaliers(ref: String): [Escalier!]!
  etat: String
  etat_elig: String
  etat_net_designer: String
  etat_prerac: String
  id: Long!
  id_immeuble: String
  id_netdesigner: String
  nombre_logement_immeuble: Int
  ref: String
  source: String
  type_desserte_abonne: String
  type_logement: String
}

type Coordonnees {
  id: Long
  rgf93: String
  wgs84: String
}

type Escalier {
  batiment: Batiment
  etages(ref: String): [Etage!]!
  id: Long!
  ref: String
}

type Etage {
  escalier: Escalier
  id: Long!
  ptos(actif: Boolean, existant: Boolean, ref: String, rompu: Boolean): [Pto!]!
  ref: String
}

type Pto {
  etage: Etage
  id: Long!
  ref: String
  source: String
  statut_access: String
  statut_actif: Boolean
  statut_existant: Boolean
  statut_net_designer: String
  type: String
}

type Query {
  adresse(codeInsee: String, codePostal: String, codeRivoli: String, cpltVoie: String, numVoie: Int, refVoieOi: String): [Adresse!]!
}
```

```diff 69:71 subtitle="Queries pour requêter les adresses"

```


```diff 1:15 subtitle="Type Adresse"

```

```diff 17:37 subtitle="Type Batiment"

```


</CodeSurfer>

---

# Questions ?

<img src='https://media0.giphy.com/media/3ohzdRoOp1FUYbtGDu/giphy.gif' width='50%'/>

---
# Demo time !

[GraphiQL](https://stark-river-82454.herokuapp.com/playground)

<img src='https://media3.giphy.com/media/2n8480RCQ2jBe/giphy.gif' width='30%'/>
