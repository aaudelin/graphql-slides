import { Image, Appear, Notes, Head, Split, Horizontal } from 'mdx-deck'
import {
  CodeSurfer,
  CodeSurferColumns,
  Step,
} from "code-surfer";
import { github, vsDark } from "@code-surfer/themes";
import "prismjs/components/prism-kotlin"

<Head>
  <title>GraphQL</title>
</Head>

# GraphQL

<img src='https://upload.wikimedia.org/wikipedia/commons/thumb/1/17/GraphQL_Logo.svg/1200px-GraphQL_Logo.svg.png' width='300'/>

---

# La technologie :rocket:

<Appear>

## Cr√©√©e ET utilis√©e par Facebook

## Outil de requ√™tage bas√© sur HTTP

</Appear>

---

<img src='https://blog.octo.com/wp-content/uploads/2018/07/screenshot_2018-07-10-graphql-vs-rest-ouvrons-les-yeux-1-1024x649.png' width='1200'/>

---

# Les notions cl√©s :dart:

---

# Contrat entre client et server

<ul>

<Appear>

<li>Utilisable sur plusieurs langages</li>
<li>Documentation auto-g√©n√©r√©e par le code</li>
<li>Typ√© et possible de documenter</li>
<li>D√©veloppement client/server ind√©pendants</li>

</Appear>

</ul>

---

<CodeSurfer theme={vsDark}>

```graphql title="Sch√©ma GraphQL"
type Adresse {
  code: String
  code_hexacle_voie: String
  code_insee: String
  code_postal: String
  code_rivoli: String
  commune: String
  compl_voie: String
  id: Long!
  maj_par_mediapost: Boolean
  nom_voie: String
  num_voie: Int
  type_voie: String
  batiments(refParam: String): [Batiment!]!
}

type Batiment {
  ad_bat_code: String
  adr: Adresse
  cas_particulier: String
  conditions_syndic: String
  coordonnees: Coordonnees
  escaliers(ref: String): [Escalier!]!
  etat: String
  etat_elig: String
  etat_net_designer: String
  etat_prerac: String
  id: Long!
  id_immeuble: String
  id_netdesigner: String
  nombre_logement_immeuble: Int
  ref: String
  source: String
  type_desserte_abonne: String
  type_logement: String
}

type Coordonnees {
  id: Long
  rgf93: String
  wgs84: String
}

type Escalier {
  batiment: Batiment
  etages(ref: String): [Etage!]!
  id: Long!
  ref: String
}

type Etage {
  escalier: Escalier
  id: Long!
  ptos(actif: Boolean, existant: Boolean, ref: String, rompu: Boolean): [Pto!]!
  ref: String
}

type Pto {
  etage: Etage
  id: Long!
  ref: String
  source: String
  statut_access: String
  statut_actif: Boolean
  statut_existant: Boolean
  statut_net_designer: String
  type: String
}

type Query {
  adresse(codeInsee: String, codePostal: String, codeRivoli: String, cpltVoie: String, numVoie: Int, refVoieOi: String): [Adresse!]!
}
```

```diff 69:71 subtitle="Queries pour requ√™ter les adresses"

```


```diff 1:15 subtitle="Type Adresse"

```

```diff 17:37 subtitle="Type Batiment"

```


</CodeSurfer>

---

# GraphQL :heart: HTTP

<ul>

<Appear>

<li>Un seul et unique endpoint (`/graphql`)</li>
<li>Une seule m√©thode HTTP (POST)</li>
<li>Echange de donn√©es au format JSON</li>
<li>S√©curisable par token</li>

</Appear>

</ul>

---

# _GraphQL is a better REST_ :punch:

---

# REST üÜö GraphQL

<Split>

<Appear>

Overfetching : donn√©es inutiles

Underfetching : manque de donn√©es et plusieurs appels

Plusieurs endpoints

</Appear>

<Appear>

Declarative fetching

Dans une seule requ√™te HTTP sur plusieurs queries

Un seul endpoint

</Appear>


</Split>

---

# GraphQL :v:

<Appear>

### Contrat d'√©change typ√© toujours √† jour
### Plus performant (nombre de requ√™tes et declarative fetching)
### Optimis√© pour de la recherche
### Exploitation simple (int√©gr√© √† SB, endpoint HTTP)

</Appear>

---


# Questions ?

<img src='https://media0.giphy.com/media/3ohzdRoOp1FUYbtGDu/giphy.gif' width='50%'/>

---
# Demo time !

[GraphiQL](http://localhost:8081/playground)

<img src='https://media3.giphy.com/media/2n8480RCQ2jBe/giphy.gif' width='30%'/>
